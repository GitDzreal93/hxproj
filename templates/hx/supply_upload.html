{% extends "base/base_site.html" %}

{% block title %} 供货面板 {% endblock title %}
{% load staticfiles %}
{% block stylesheets %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/hx/supply.css' %}">
<!--上传文件css-->
<link href="/static/css/fileinput.min.css" rel="stylesheet">

{% endblock stylesheets %}

{% block content %}

<div class="right_col" role="main">

    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                已有供货商 <span>{{ msg }}</span>
                <button class="btn btn-success pull-right" data-toggle="modal" data-target="#mymodal-data"
                        data-whatever="@mdo">
                    <span class="glyphicon "></span> 导入
                </button>

            </div>
            <!-- 模态弹出窗内容 -->
            <div class="modal" id="mymodal-data" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">
                                <span aria-hidden="true">×</span>
                                <span class="sr-only">Close</span>
                            </button>
                            <h4 class="modal-title">请选择文件</h4>
                        </div>
                        <div class="modal-body">
                            <!--选择文件-->
                            <input id="excelFile" type="file">
                        </div>
                        <div class="modal-footer">

                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                            <!--{% csrf_token %}-->
                            <!--<button type="button" class="btn btn-success" data-target="#modal-save-input"-->
                                    <!--onclick="SaveImport()">保存-->
                            <!--</button>-->
                                {% csrf_token %}
                                <input type="submit">

                        </div>
                    </div>
                </div>
            </div>
            </form>

            <div class="panel-body">
                <div class="col-md-12">
                    <table class="table table-striped table-bordered table-hover table-responsive">
                        <thead>
                        <tr>
                            <th class="th-code">商家代码</th>
                            <th class="th-classified">公司分类</th>
                            <th class="th-office">办事处</th>
                            <th class="th-name">商家名称</th>
                            <th class="th-date">订单日期</th>
                            <th class="th-order">订单号</th>
                            <th class="th-model">型号</th>
                            <th class="th-number">要货数量</th>
                            <th class="th-offer_price">供价</th>
                            <th class="th-amount_price">要货金额</th>

                        </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>
                <div class="col-md-12 text-right">
                    <button class="btn btn-success" data-toggle="modal" data-target="#modal-add-supplier">
                        <span class="glyphicon glyphicon-plus"></span> 新增供货商
                    </button>
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock content %}

{% block javascripts %}
{{ block.super}}
<!-- Chart.js -->
<script src="/static/vendors/Chart.js/dist/Chart.min.js"></script>
<!-- gauge.js -->
<script src="/static/vendors/gauge.js/dist/gauge.min.js"></script>
<!-- Skycons -->
<script src="/static/vendors/skycons/skycons.js"></script>
<!-- Flot -->
<script src="/static/vendors/Flot/jquery.flot.js"></script>
<script src="/static/vendors/Flot/jquery.flot.pie.js"></script>
<script src="/static/vendors/Flot/jquery.flot.time.js"></script>
<script src="/static/vendors/Flot/jquery.flot.stack.js"></script>
<script src="/static/vendors/Flot/jquery.flot.resize.js"></script>
<!-- Flot plugins -->
<script src="/static/vendors/flot.orderbars/js/jquery.flot.orderBars.js"></script>
<script src="/static/vendors/flot-spline/js/jquery.flot.spline.min.js"></script>
<script src="/static/vendors/flot.curvedlines/curvedLines.js"></script>
<!-- DateJS -->
<script src="/static/vendors/DateJS/build/date.js"></script>
<!-- JQVMap -->
<script src="/static/vendors/jqvmap/dist/jquery.vmap.js"></script>
<script src="/static/vendors/jqvmap/dist/maps/jquery.vmap.world.js"></script>
<script src="/static/vendors/jqvmap/examples/js/jquery.vmap.sampledata.js"></script>

<!--bootstrap上传文件js-->
<script src="/static/js/fileinput.min.js"></script>
<script language=javascript>
    function SaveImport(){
        console.log("wqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq");
        var myfile = document.getElementById("excelFile").files;//获取文件
        var totalfile = myfile.length;//上传的文件个数
        var uploadedfile = 0;//已上传的文件个数
        var data = new FormData();//构建FormData用于Ajax发送
        var file_index = 0;
        data.append('file', myfile);// 获取1个文件放入FormData中
        //data.append('csrfmiddlewaretoken','{{ csrf_token }}');
        $.ajax({
            type: "POST",
            url: "/apptest/view/fileUpload/",
            data: data,
            processData: false, // 告诉jQuery不要处理数据
            contentType: false, // 告诉jQuery不要设置类型
            dataType:"json",
            success: function(result){
                //每次上传完毕后得到返回值，取出返回的json值
                uploadedfile = uploadedfile + 1;
                if(uploadedfile == totalfile){
                    $("#upload_status").text("重新上传");
                    alert("文件上传完毕！");
                }
            },
            error: function () {
                alert("上传失败！");
            }
        });

    }

</script>
{% endblock javascripts %}
